<div class="user-info" >
  <div class="main-info">
    <mat-card class="card-main">
      <mat-card-title>
        <div mat-card-avatar class="mat-header-image"><img src="{{imgLink.link}}" width="100" height="100"></div>
        <div class="user-name">
          {{myUser.firstName}}
          {{myUser.lastName}}
          {{myUser.middleName}}
        </div>


      </mat-card-title>
      <div *ngIf="!showUserInfoEdit">
      <mat-card-content>
        Gender:
        {{myUser.gender.name}}
      </mat-card-content>

      </div>
      <div *ngIf="showUserInfoEdit">
        <mat-card-content>
          <mat-form-field>
            <mat-select placeholder="{{selectedGender.name}}" [formControl]="genderControl">
              <mat-option *ngFor="let gender of genderList" [value]="selectedGender" (click)="genderApply($event, gender)">
                {{gender.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-card-content>
      </div>

      <mat-card-content>
        <button mat-button (click)="showEditUserInfo()">Edit.</button>
      </mat-card-content>

      <mat-card-content *ngIf="showUserInfoEdit">
        <button mat-button (click)="applyChangeGender()">Apply.</button>
      </mat-card-content>

      <mat-card-content *ngFor="let educate of education">
        <div *ngIf="!isChangeEducation[educate.id]">
        {{educate.typeOfEducation.name}}.
        <br>
        University:
        {{educate.department.faculty.university.name}}
        <br>
        Faculty:
        {{educate.department.faculty.name}}
        <br>
        Department:
        {{educate.department.name}}
        <br>
        End education:
        <br>
        {{educate.dateOfEnd}}
        </div>

        <div *ngIf="isChangeEducation[educate.id]">
          <mat-card-content>
            <mat-form-field>
              <mat-select placeholder="{{educate.typeOfEducation.name}}" [formControl]="typeOfEducationControl">
                <mat-option *ngFor="let type of typesOfEducation" [value]="selectedTypeOfEducation" (click)="typeOfEducationApply($event, type)">
                  {{type.name}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </mat-card-content>

          <mat-card-content>
            <form (submit)="changeUniversity(educate)">
              <mat-form-field class="example-full-width">
                <input type="text" placeholder="University: {{educate.department.faculty.university.name}}" aria-label="Assignee" matInput [formControl]="universityControll" [matAutocomplete]="auto">
                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayEducationFn">
                  <mat-option *ngFor="let option of filteredUniversity | async" [value]="option">
                    {{ option.name }}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
            </form>
          </mat-card-content>
        </div>

        <mat-card-content>
          <button mat-button (click)="changeEducation(educate)">Ch</button>
        </mat-card-content>

        <div *ngIf="isChangeEducation[educate.id]" class="change-education">
          <mat-card-content>
            <button mat-button (click)="applyChangeEducation()">apply</button>
          </mat-card-content>
          <mat-card-content>
            <button mat-button (click)="deleteEducation(educate)">delete</button>
          </mat-card-content>
        </div>
      </mat-card-content>

      <mat-card-content>
        <button mat-button (click)="addEducation()">Add</button>
      </mat-card-content>

      <mat-card-content *ngFor="let company of userCompany">
        Work:
        {{company.company.name}}
        Position:
        {{company.position.name}}

        <mat-card-content>
          <button mat-button (click)="changeWork(company)">Ch</button>
        </mat-card-content>

        <div class="change-work" *ngIf="isChangeWork[company.idUserCompany]">
          <mat-card-content>
            <button mat-button (click)="applyChangeCompany()">apply</button>
            <button mat-button (click)="deleteWork(company)">delete</button>
          </mat-card-content>
        </div>
      </mat-card-content>

      <mat-card-content>
        <button mat-button (click)="addWork()">Add</button>
      </mat-card-content>


    </mat-card>

    <mat-card class="card-contacts">
      <mat-card-title>
        City: {{myUser.city.name}}
        <mat-card-content>
          <button mat-button (click)="changeCity()">Ch</button>
        </mat-card-content>
      </mat-card-title>
      <mat-card-title>
        Contact info:
      </mat-card-title>
      <mat-card-content>
        Email:
        {{myUser.email}}
        <mat-card-content>
          <button mat-button (click)="changeEmail()">Ch</button>
        </mat-card-content>
      </mat-card-content>
      <mat-card-content *ngFor="let link of links">
        {{link.typeOfLink.name}}:

        {{link.link}}

        <mat-card-content>
          <button mat-button (click)="changeLink(link)">Ch</button>
        </mat-card-content>
      </mat-card-content>

      <mat-card-content>
        <button mat-button (click)="addLink()">Add</button>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="skill-info">
    <mat-card class="card-skill">
      <mat-card-title>
        Skills
      </mat-card-title>
      <mat-card-content>
        <mat-chip-list>
          <mat-chip *ngFor="let skill of myUser.skill">
            {{skill.skill.name}}
            <button mat-button class="skill-button" (click)="editSkill(skill)" [disabled]="!removable">C</button>
            <button mat-button class="skill-button" (click)="removeSkill($event, skill)" [disabled]="!removable">R</button>
          </mat-chip>
        </mat-chip-list>
      </mat-card-content>

      <div class="remove-skill">
        <mat-card-content>
          <button mat-button (click)="showRemoveSkill()">
            Change.
          </button>
        </mat-card-content>
      </div>




      <div class="add-skill">
        <mat-card-content>
          <form (submit)="addSkill()">
            <mat-form-field class="example-full-width">
              <input type="text" placeholder="Add skill" aria-label="Assignee" matInput [formControl]="myControl" [matAutocomplete]="auto">
              <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
                  {{ option.name }}
                </mat-option>
              </mat-autocomplete>
          </mat-form-field>
          </form>
        </mat-card-content>
        <mat-card-content class="add-new-skill">
          <button mat-button (click)="showAddSkill()">{{show ? 'Hide' : 'Show'}}
            Create new skill
          </button>
        </mat-card-content>
      </div>

      <form [formGroup]="inputSkillForm">
        <div *ngIf="show">
          <mat-form-field onsubmit="acceptCreateSkill()">
            <input type="text" placeholder="Skill name" matInput formControlName="nameOfNewSkill" required>
          </mat-form-field>


          <mat-form-field>
            <mat-select placeholder="Type of skill*" [formControl]="typeOfSkillControl">
              <mat-option *ngFor="let type of typeOfSkills" [value]="typeOfSkills" (click)="refine($event, type)">
                {{type.name}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="typeOfSkillControl.hasError('required')">Please choose type of skill</mat-error>
          </mat-form-field>

          <button mat-button (click)="acceptCreateSkill()" [disabled]="inputSkillForm.invalid"> Accept
          </button>
        </div>
      </form>
    </mat-card>

    <mat-card class="card-history">
      <mat-card-title>history</mat-card-title>
      <mat-card-subtitle>
        History:
        {{skills}}
      </mat-card-subtitle>
    </mat-card>
  </div>
</div>
